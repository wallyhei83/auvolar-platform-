(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[111],{12558:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p});var l=a(88111),r=a(55271),t=a(12326),i=a(67022),n=a(1130),c=a(25460),d=a(29772),o=a(84181),h=a(56192),u=a(93447),x=a(48786),j=a(21422),m=a(76611);function p(){var e,s,a;let{data:r}=(0,m.useSession)(),{toast:t}=(0,o.d)();return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Account Settings"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage your profile and security"})]}),(0,l.jsx)(v,{}),(0,l.jsx)(g,{}),(0,l.jsxs)(d.Zp,{children:[(0,l.jsx)(d.aR,{children:(0,l.jsx)(d.ZB,{children:"Account Details"})}),(0,l.jsx)(d.Wu,{children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-500",children:"Email"}),(0,l.jsx)("p",{className:"font-medium",children:(null==r||null==(e=r.user)?void 0:e.email)||"—"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-500",children:"Account Type"}),(0,l.jsx)("p",{className:"font-medium",children:(null==r||null==(s=r.user)?void 0:s.role)||"—"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-500",children:"Company"}),(0,l.jsx)("p",{className:"font-medium",children:(null==r||null==(a=r.user)?void 0:a.companyName)||"—"})]})]})})]})]})}function v(){let{data:e}=(0,m.useSession)(),{toast:s}=(0,o.d)(),[a,n]=(0,r.useState)(""),[j,p]=(0,r.useState)(""),[v,g]=(0,r.useState)(""),[y,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(null==e?void 0:e.user)&&(n(e.user.name||""),p(e.user.companyName||""))},[e]);let f=async()=>{N(!0);let e=await fetch("/api/user/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,companyName:j,phone:v})});N(!1),e.ok?s({title:"Profile updated"}):s({title:"Failed to update",variant:"destructive"})};return(0,l.jsxs)(d.Zp,{children:[(0,l.jsxs)(d.aR,{children:[(0,l.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(h.A,{className:"h-5 w-5"})," Profile"]}),(0,l.jsx)(d.BT,{children:"Update your personal information"})]}),(0,l.jsxs)(d.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"Name"}),(0,l.jsx)(i.p,{value:a,onChange:e=>n(e.target.value)})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"Company"}),(0,l.jsx)(i.p,{value:j,onChange:e=>p(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"Phone"}),(0,l.jsx)(i.p,{value:v,onChange:e=>g(e.target.value),placeholder:"(555) 123-4567"})]})]}),(0,l.jsxs)(t.$,{onClick:f,disabled:y,children:[y?(0,l.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,l.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})}function g(){let{toast:e}=(0,o.d)(),[s,a]=(0,r.useState)(""),[i,h]=(0,r.useState)(""),[x,m]=(0,r.useState)(""),[p,v]=(0,r.useState)(!1),g=async()=>{if(i!==x)return void e({title:"Passwords do not match",variant:"destructive"});if(i.length<8)return void e({title:"Password must be at least 8 characters",variant:"destructive"});v(!0);let l=await fetch("/api/user/password",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:s,newPassword:i})});v(!1),l.ok?(e({title:"Password changed successfully"}),a(""),h(""),m("")):e({title:(await l.json()).message||"Failed to change password",variant:"destructive"})};return(0,l.jsxs)(d.Zp,{children:[(0,l.jsxs)(d.aR,{children:[(0,l.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(j.A,{className:"h-5 w-5"})," Change Password"]}),(0,l.jsx)(d.BT,{children:"Keep your account secure"})]}),(0,l.jsxs)(d.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"Current Password"}),(0,l.jsx)(n.y,{value:s,onChange:e=>a(e.target.value)})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"New Password"}),(0,l.jsx)(n.y,{value:i,onChange:e=>h(e.target.value),placeholder:"Min 8 characters"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c.J,{children:"Confirm New Password"}),(0,l.jsx)(n.y,{value:x,onChange:e=>m(e.target.value)})]})]}),(0,l.jsxs)(t.$,{onClick:g,disabled:p,children:[p?(0,l.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,l.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Change Password"]})]})]})}},56192:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(7340).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},88507:(e,s,a)=>{Promise.resolve().then(a.bind(a,12558))}},e=>{e.O(0,[5526,16,9138,814,9743,7358],()=>e(e.s=88507)),_N_E=e.O()}]);